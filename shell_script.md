### 4. 셸 스크립트
- 셸
    - 사용자가 입력한 명령을 해석해 커널에 전달하거나, 커널의 처리 결과를 사용자에게 전달하는 역할
    - Server(B)의 텍스트모드나 X윈도의 터미널 처럼 명령어를 입력하는 환경이라고 보면 된다.
- bash shell
    - CentOS에서 기본으로 제공하는 shell
    - 특징
        - Alias 기능(명령어 단축)
        - History 기능
        - 연산 기능
        - Jon Control 기능
        - 자동 이름 완성 기능(tab)
        - 프롬프트 제어 기능
        - 명령 편집 기능
    - 만약 ls -al을 ls2로 쓰고 싶다면 alias ls2="ls -al"처럼 지정 가능
- 명령문 처리 방법
    - 옵션이나 인자를 사용 가능
    - (프롬프트) 명령어 [옵션..] [인자..]
- 환경변수
    - 셸은 여러 환경변수 값을 갖는다.
    - 설정된 환경변수는 `echo $환경변수이름`형식으로 명령어를 실행시 확인 가능
    - 예로 호스트이름 : `echo $HOSTNAME`
    - 환경변수 값 변경 : `export 환경변수=값`
    - 이외의 환경변수는 `printenv`로 출력됨(몇 개는 나오지 않을 수도 있다.)
- 셸 스크립트 프로그래밍
    - 리눅스는 대부분 C로 작성되어 C 언어와 유사하게 프로그래밍 가능
    - 일반적인 프로그래밍 언어와 같이 변수, 반복문, 제어문 등을 사용가능
    - 별도로 컴파일하지 않고 텍스트 파일 형태로 셸에서 바로 실행가능
    - 주로 vi 에디터나 gedit으로 작성하는 편이다.
- 스크립트 작성
    - vi name.sh와 같이 실행해 간단한 스크립트 작성
    - `#!/bin/sh` : bash셸로 해석하겠다는 의미. 반드시 1행에 해야함.
    - `echo "사용자 이름" : $USERNAME`
    - `echo "호스트 이름" : $HOSTNAME`
    - `exit 0` : 종료코드를 반환함.
    - 실제 스크립트 실행과는 무관하나 셸 스크립트는 실행중에 문제가 생겨도 무조건 성공했다는 메시지를 내보내기에, 직접 마지막 행에서 성공/실패를 반환하는 것이 좋다. 0은 성공
- 실행
    - `sh sh파일`로 실행할 수 있다. 이 경우 셸 스크립트의 속성 변경이 필요없다. : `sh name.sh`
    - 또는 실행가능으로 변경하고 `./스크립트파일`로 실행할 수도 있다. : `chmod a+x name.sh`, `./name.sh`
    - ./를 붙이는 이유는 현재 디렉토리에서 실행토록 하기 위함이다. 그냥 이름만 하면 $PATH에 지정된 곳에서만 찾게된다.
    - 셸 스크립트는 root사용자 권한으로 작성시 root사용자만 권한 변경이 가능. 다른 사용자도 쓰게 하려면 /usr/local/bin/에 복사하고 권한을 755로 변경해야함.
- 변수
    - 필요한 값을 계속 저장해 나간다는 개념
    - 셸 스크립트에서는 변수를 사용 전에 미리 선언하지 않음. 처음 변수에 값이 할당되면 자동으로 변수가 생성
    - 변수에 넣는 모든 값은 '문자열'로 취급. 즉, 숫자를 넣어도 문자 취급
    - 변수 이름은 대소문자를 구분. $aa와 $AA는 다름
    - 변수 대입시 =좌우에는 공백 없이!, 값의 공백은 ""로 묶는다.
    - 터미널에 testvar="Hello Hi"라고 입력하면 $testvar를 출력할 수 있다.
    - read myvar와 같이 스크립트에 추가하면 사용자의 표준입력 값이 변수에 저장된다.
- 숫자계산
    - 변수의 값은 모두 문자열로 취급된다.
    - 만약, 변수에 들어 있는 값에 + - * / 등 연산을 하려면 expr키워드를 넣어야 한다.
    - 단, 수식과 함께 그 전체를 ``로 묶어야 한다.
    - 또한 *기호와 같은 경우 \를 이용해 붙여줘야만 한다.(괄호도)
    - ex) num3=`expr $num1 + 200`
    - ex) num4=`expr \( $num1 + 200 \) / 10 \* 2`
- 파라미터변수
    - $0, $1, $2와 같은 형태를 갖는다. 실행하는 명령의 부분 하나하나를 변수로 지정한다는 의미
    - 아래와 같은 sh파일이 있다고 하자
    - `#!/bin/sh`
    - `echo "실행파일 이름은 <$0>이다"`
    - `echo "첫번째 파라미터는 <$1>이고, 두번째 파라미터는 <$2>이다."`
    - `echo "전체 파라미터는 <$*>이다."`
    - `exit 0`
    - sh paravar.sh 231 322 32312 222
    - 를 하면 $0에는 parvar.sh가 들어가고 차례로 그 다음 순서로 들어감. $*는 전체 variable을 다 출력($0제외)
- if문과 case문
    - 기본 : `if [ 조건 ] then 참일 경우 실행 fi`
    - 주의할 것은 조건사이의 각 단어는 반드시 띄워야 한다는 것이다.
    - if ~ else문 : `if [ 조건 ] then 참일 경우 실행 else 거짓인 경우 실행 fi`
    - 연산자는 <a href="http://www.iwiz.pe.kr/bbs/view/system/article_24.html">여기</a>를 참조하자
- case문과 esac문
    - if문은 참 거짓 2중 분기만 가능.
    - 여러 분기가 필요시 case문 활용(다중 분기)
    - 주의할 점은 각 분기마다 ;;로 끝이라는 표시를 해주어야 한다는 것이다.
- and or 관계연산자
    - and : -a 혹은 &&
    - or : -o 혹은 ||
- 반복문(for ~ in)
    - 기본 : `for 변수 in 값1 값2 값3 do 반복할 문장 done`
- 반복문(while)
    - 조건식이 참인 동안 계속해서 반복하는 특성을 갖는다.
    - 만약 `while [ 1 ] do ~~ done exit 0`라고 한다면 do 와 done사이의 내용을 무한반복할 것이다.
    - 조건식에 [ 1 ] 또는 [ : ]가 오면 항상 참이다.
- 반복문(until)
    - while문과 용도는 같지만, until은 조건식이 참일 때까지(즉, 거짓인 동안) 계속 반복한다.
- break, continue, exit, return
    - break는 반복문을 주로 종료시킴
    - continue는 반복문의 조건식으로 돌아가도록
    - exit는 해당 프로그램 종료
    - return은 함수 안에서 사용. 함수를 호출한 곳으로 돌려보냄
- 사용자 정의 함수
    - 기본 : `함수이름 () { 내용.. } 함수이름`
    - 즉, 정의하고 호출
    - 함수의 파라미터 : 함수를 호출시에 뒤에 파라미터를 붙여서 호출하며, 함수 안에는 $1, $2,... 로 사용함.
        - 기본 : `함수이름 () { $1, $2 ... } 함수이름 파라미터1 파라미터2`
- eval
    - 문자열을 명령문으로 인식하고 실행함.
    - 만약 str="ls -l anaconda-ks.cfg"로 해놓으면
    - echo $str은 해당 문자열 전체를 출력한다.
    - 그러나, eval $str은 해당 명령을 수행한다.
- export
    - 외부 변수로 선언함.
    - 즉, 선언한 변수를 다른 프로그램에서도 사용가능토록 함.
- printf
    - c언어의 printf() 함수와 비슷하게 형식을 지정하여 출력 가능
- set과 $(명령어)
    - 리눅스 명령어를 결과로써 사용하려는 경우 $(명령어)로 사용해야 한다.
    - 또 결과를 파라미터로 사용코자 하는 경우, set명령어와 함께 사용한다.
    - 아래를 보자
    - `#!/bin/sh`
    - `echo 오늘 날짜는 $(date) 입니다.` : 리눅스 명령어 date를 결과로써 사용
    - `set $(date)` : 해당 결과를 파라미터로 사용함. date의 결과는 여러개의 parameter로 구성됨
    - `echo "오늘은 $4요일 입니다."` : 해당 파라미터 중 4번 째를 출력
- shift
    - 파라미터 변수를 한 단계씩 아래로 쉬프트 시킨다.
    - 모든 파라미터 변수를 출력하고 싶거나, 트깋 10개가 넘는 파라미터 변수에 접근시 사용
    - 단, $0 파라미터 변수는 변경되지 않는다.
