### 네임서버
- 네임서버
    - DNS서버라고도 부르며, 웹 브라우저나 FTP 클라이언트를 사용할 때 등과 같이 URL을 사용
    - 실제 원하는 서버로 가기 위해선 이 주소를 IP로 변환해야 하는데 그 역할을 하는 것이 nameserver
- hosts
    - 수많은 서버의 주소를 적어 놓는 파일
    - 리눅스에서는 /etc/hosts
    - 일정 수준의 많은 서버 규모는 hosts파일이 해결책이 될 수 있다.
    - 해당 파일에 주소를 추가하면 직접 찾아갈 수 있을 테니.
    - 하지만, 새로 생기는 서버나 변경되는 주소를 실시간으로 알아낼 수는 없다.
    - 그래서 이름 해석을 전문으로 해주는 서버 컴퓨터가 필요해졌으며, 이를 네임 서버 또는 DNS서버라고 부르게 되었다.
- VMware
    - 현재 여기서는 네임서버는 192.168.111.2로 되어 잇따. 따러서 이것이 DNS서버
    - `cat /etc/resolv.conf`로 확인 가능
    - 만약 해당 내용을 주석처리하면 firefox로 접속하려 해도 안될 것이다.
    - 하지만, IP주소로 직접 접속하면 가능. 왜냐하면 DNS를 통하지 않아도 되기 때문이다.
    - 혹은 /etc/hosts에 해당 서버를 추가하면 nameserver를 통하지 않아도 접속 가능하다.
- 과정
    - 사용자로부터 요청이 오면 /etc/host.conf를 먼저 조회한다. 우선순위를 확인하는 것이다.
        - multi on이라고 되어 있으면 /etc/hosts에 여러 개의 url이 설정된다는 의미다.
        - order hosts.bind라고 입력됐거나, 생략인경우 /etc/hosts를 먼저 찾는다. 없으면 bind 즉, /etc/resolv.conf에 설정된 네임 서버에 질의한다.
    - /etc/hosts가 우선순위이므로 찾아서 해당 url이 없으면 /etc/resolv.conf로 가고 있으면 그냥 접속
    - /etc/resolv.conf에 nameserver로 지정되어 있는 것이 있으면 해당 네임서버에서 ip주소를 질의하고 없으면 찾을 수 없다.
- 네임서버의 구축
    - 도메인 이름 체계
        - 네트워크에 연결된 컴퓨터를 구분하는 유일한 방법은 IP주소다. 따라서 웹 브라우저로 웹 서버에 접속시에는 IP주소를 알아야 한다.
        - 주소가 외우기 어렵기 때문에 각 컴퓨터의 ip주소에 외우기 쉬운 이름을 부여해야 한다.
        - 현재는 트리 구조 형태의 도메인 이름 체계가 고안되었다. 
        - ROOT(.) 네임 서버는 1단계 네임 서버인 com네임 서버, net 네임 서버, org네임 서버, edu네임 서버 등과 국가 도메인인 kr, fr, sp등을 관리한다.
        - 또 1단계 네임 서버는 자신의 하위에 있는 2단계 네임 서버를 관리하면 된다. 예를 들어 com 네임 서버는 nate, google, naver 등 2단계 도메인을 관리하는 네임 서버만 관리하면 되는 것이다.
        - nate.com은 www, ftp, mail 컴퓨터를 관리함
    - 로컬 네임 서버가 작동하는 순서
        - 리눅스에는 각자 사용하는 네임서버가 /etc/resolv.conf 파일에 nameserver 로 지정되어 있다.
        - 그러나 이 로컬 네임 서버는 모든 주소를 관리할 수 없다. 그래서 자신이 아는 주소면 바로 알려주는데, 모른다면 다른 과정을 거친다.
        - 해당 과정은, ROOT, COM등의 네임 서버에 질의하고 응답을 차례로 받아낸 다음 nate.com을 관리하는 서버에 해당 총 주소를 질의하고 얻어낼 수 있다.
    - 캐싱 전용 네임 서버
        - PC에서 URL로 IP주소를 얻고자 할 때, 해당하는 URL의 IP 주소를 알려주는 네임서버를 의미한다.
        - 이전에 192.168.111.2는 네임 서버라고 했는데, 이는 VMware가 직접 운영해주는 가상의 네임서버다.
        - 이는 사설 네트워크 입장에서 외부의 컴퓨터이다. 따라서, 이제는 이를 사용치 않고 직접 네임서버를 구축해서 인터넷을 이용해볼 수 있다.
        - 서버(B) 혹은 Client에 접속하여 /etc/resolv.conf의 내용을 주석 표시한다.
        - 서버에서 `yum -y install bind bind-chroot`로 입력해 네임 서버와 관련된 패키지를 설치
        - /etc/named.conf 를 vi 에디터로 열고 수정. 11, 12, 17행에서 {} 부분을 각각 any; , none; , any;로 수정
        - 그러고 named 데몬 서비스를 재시작 : `systemctl restart named`
        - 항상 가동 : `systemctl enable named`
        - 방화벽에서 영구적 - dns 체크
        - 작동 확인 : `dig @192.168.111.100 www.nate.com` : 해당 네임서버IP로 조회할 URL을 검색하는 것.
        - nslookup을 사용해도 됨 : server 192.168.111.100 // www.nate.com // exit
        - 이와 같이 server를 캐싱전용네임서버로 사용한 것이다.
        - 다른 client, server(B)로 접속하여 nslookup을 하고 server 192.168.111.100으로 테스트한 다음, /etc/resolv.conf에서 nameserver를 바꾸어 사용할 수 있다.
        - 텍스트모드는 elinks 패키지를 이용해 인터넷 접속 가능
- 마스터 네임 서버
    - 도메인에 속해 있는 컴퓨터들의 이름을 관리하고, 외부에서 www.도메인, ftp.도메인 등의 컴퓨터 IP 주소를 알기 원할 때 해당 컴퓨터의 IP 주소를 알려주는 네임서버를 의미한다.
    - 테스트
        - Server(B)에는 FTP 서버 설치, Server는 nameserver와 웹 서버 설치
        - 네임서버 설정에서 Server는 www.john.com을 192.168.111.100으로 설정하고, ftp.john.com을 Server(B)의 IP주소인 192.168.111.200으로 설정
        - Client는 www.nate.com을 요청하면 Server에 질의할 것이고 Server는 외부에서 해당 IP를 가져와 접속시켜줄 것이다.
        - 이는 캐싱 전용 서버와 별 차이가 없다.
        - 이번에는 Client에서 www.john.com의 접속을 시도할 때의 과정을 살펴본다.
            - 100에게 www.john.com 의 IP를 요청하면, Server는 자신의 DB를 검색해 그것이 있는지 확인하고 자신이 관리하는 도메인이므로 그 IP주소를 바로 전달해준다.(ftp주소도 같이)
            - 외부 인터넷상에서 ftp.john.com으로 접속을 시도하면, 자신의 로컬 네임 서버에게 해당 주소를 요청하고, 없으니까 ROOT네임서버에게 해당 내용을 요청한다.
            - COM서버 주소를 받고 다시 COM에 요청할 것이고, 이제 다시 john.com네임 서버의 주소인 192.168.111.100을 로컬 네임 서버에게 알려줄 것이다.
            - 로컬 네임 서버는 자신의 DB에 ftp.john.com의 주소가 있으므로 해당 주소인 192.168.111.200을 알려준다. 그리고 인터넷상의 컴퓨터는 192.168.111.200, 즉 Server(B)에 접속한다.
        - 실질적인 내용은 교재 참조
- 라운드로빈 방식의 네임 서버
    - 접속이 한 번에 수십만 이상이 있을 수 있다. 이런 경우 1대의 웹서버가 아니라, 여러 대의 웹서버를 운영하여, 웹 클라이언트가 서비스를 요청할 경우에 교대로 서비스를 실행
    - 이에 따라 부하를 공평하게 여러 대가 나눌 수 있다. 이 방식이 라운드 로빈
